{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://bbc.github.io/bbcat-orchestration/schemas/device.json",
  "title": "Device",
  "definitions": {
    "device": {
      "description": "Device properties as used by the allocation algorithm",
      "type": "object",
      "required": [
        "deviceId",
        "deviceIsMain",
        "deviceJoiningNumber",
        "deviceCurrentNumber",
        "deviceTags"
      ],
      "additionalProperties": false,
      "properties": {
        "deviceId": {
          "description": "Unique identifier for this device, automatically generated",
          "type": "string"
        },
        "deviceIsMain": {
          "description": "True if this device is the main device (the device that manages playback and allocations)",
          "type": "boolean"
        },
        "deviceCategory": {
          "description": "Device category as detected by the application",
          "type": "string",
          "enum": ["mobile", "tablet", "desktop", "unknown"]
        },
        "deviceJoiningNumber": {
          "description": "Original position in the joining order",
          "type": "integer"
        },
        "deviceCurrentNumber": {
          "description": "Current position in the joining order",
          "type": "integer"
        },
        "deviceLatency": {
          "description": "Emission delay, in milliseconds, if known",
          "type": "integer"
        },
        "deviceGain": {
          "description": "Calibration gain multiplier to be applied to the output from the device, if known",
          "type": "number",
          "minimum": 0
        },
        "deviceTags": {
          "description": "List of tag groups and the user selections applied to the device",
          "type": "array",
          "items": {
            "description": "The selection for a specific tag group",
            "type": "object",
            "required": [
              "tagId",
              "tagValues"
            ],
            "properties": {
              "tagId": {
                "description": "The unique identifier for this tag group",
                "type": "string"
              },
              "tagValues": {
                "description": "The selections made for this tag group; this may be a default value if no selection was made",
                "type": "array",
                "items": {
                  "oneOf": [
                    { "type": "string" },
                    { "type": "number" }
                  ]
                }
              }
            }
          }
        }
      }
    }
  }
}
